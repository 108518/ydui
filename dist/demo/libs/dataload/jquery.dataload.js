!function(o){"function"==typeof define?define(["jquery"],o):o(jQuery)}(function(o){o.fn.dataload=function(e){return this.each(function(){function a(o,e){clearTimeout(o.tid),o.tid=setTimeout(function(){o.call(e)},200)}var n=o.extend({url:"",type:"get",dataType:"json",data:{},page:1,jsonpCallback:"",pageSize:10,pagestr:"page",initLoad:!0,loadtype:"click",triggerdom:"",appenddom:"",loadmoredom:"",loadingdom:"",callback:null},e),i=this,t=o(n.loadmoredom,i),d=o(n.loadingdom,i);o(i).append('<div id="J_DataLoadTag"></div>');var l={isloading:!1,isdone:!1,page:n.page,pageSize:n.pageSize,getContent:function(){var e=this;l.isloading||l.isdone||(l.isloading=!0,e.showLoading(),n.data[n.pagestr]=l.page,"jsonp"==n.dataType&&n.jsonpCallback&&o.ajaxSetup({jsonpCallback:n.jsonpCallback}),o.ajax({url:n.url,type:n.type,data:n.data,dataType:n.dataType,cache:!1,success:function(o){return l.page++,"function"==typeof n.callback&&n.callback(o,l.page-1),o.length<l.pageSize?(l.hideLoadMore(),void(l.isdone=!0)):void l.showLoadMore()},error:function(){console.error("网络错误")},complete:function(){e.hideLoading(),l.isloading=!1}}))},hideLoadMore:function(){"click"==n.loadtype&&t.hide()},showLoadMore:function(){"click"==n.loadtype&&t.show()},showLoading:function(){this.hideLoadMore(),d.show()},hideLoading:function(){d.hide()}};if(n.initLoad)l.getContent();else{if(!n.triggerdom)return void console.error("参数【triggerdom】必填");o(n.triggerdom,i).one("click",function(){l.getContent()})}if("scroll"==n.loadtype){var c=o(window).height();o(window).on("scroll",function(){a(function(){o("#J_DataLoadTag").offset().top<=c+o(window).scrollTop()+c/4&&l.getContent()},window)})}else{if(!n.loadmoredom)return void console.error("参数【loadmoredom】必填");t.on("click",function(){l.getContent()})}})}});